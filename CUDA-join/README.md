# Implemented GPU-Accelerated TPC-H Query 18

---



This project leverages GPU acceleration to enhance the performance of TPC-H Query 18 using CUDA. The source code based on the open-source project [GPU-Joins-Evaluation](https://github.com/BowenforGit/GPU-Joins-Evaluation), our implementation focuses on the Sort-Merge Join methodology to efficiently handle relational joins on GPUs.
**Github Open Source Project Name：** GPU-Joins-Evaluation: Evaluate state-of-the-art GPU joins
**URL：**https://github.com/BowenforGit/GPU-Joins-Evaluation

## Project Overview

- bin: executable files and results record files
- obj: ouput file generated by Makefile compiling
- tpch-data-files: all the data files



## Environment Setup

To replicate our performance tests, ensure your environment matches the following specifications:

### Hardware Requirements

- **GPU**: GTX1080 Ti 11GB
- **CPU**: Intel(R) Xeon(R) Silver 4108 CPU @ 1.80GHz 4Cores
- **Memory**: 28GB

### Software Requirements

- **CUDA**: 12.2
- **GPU Driver**: 535.146.02
- **gcc/g++**: 10.3.0
- **NVCC**: 11.7
- **Java JDK**: 1.8
- **GNU make**: 3.81 or newer

## Compilation and Execution

### Compilation

The provided Makefile simplifies the compilation process. Ensure the following paths and flags are set correctly in the `Makefile`:

#### Compile Flags

```makefile
CFLAGS = -O3 -march=native -w
NVCCFLAGS = -O3 -arch=sm_61 -allow-unsupported-compiler -std=c++17 -Xcompiler -fPIC -ccbin=$(GCC) -w
CUDA_PATH = /userhome/2072/msp23007/anaconda3/pkgs/cuda-toolkit
CUDA_INCLUDE = $(CUDA_PATH)/include
PROJECT_INCLUDE = $(shell pwd)
```



#### GPU Memory Settings in `utils.cuh`

```c++
// Choose your own memory pool size
// constexpr size_t mem_pool_size = 25769803776 * 0.9;
// 8188 MiB to Byte
constexpr size_t total_gpu_memory = 8188ULL * 1024 * 1024;
constexpr double usage_fraction = 0.85; // Using 85% of total memory
constexpr size_t mem_pool_size = static_cast<size_t>(total_gpu_memory * usage_fraction);
```

### Execution

To run the compiled `tpch_q18.cu` file, use the following command-line syntax:

```shell
./tpch_q18 SMJ result.txt
```

All binary data files should be located in the `tpc-data-files` subdirectory within the current directory.

### Example Commands

1. **Clone the repository**:

   ```shell
   git clone https://github.com/BowenforGit/GPU-Joins-Evaluation.git
   cd GPU-Joins-Evaluation
   ```

2. **Compile the project**:

   ```shell
   make
   ```

3. **Run the executable**:

   ```shell
   # Enter the ./bin directory
   ./tpch_q18 SMJ result.txt
   ```